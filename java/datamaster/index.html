<html>

<style>
	* {
		font-family: Calibri;
	}
	.node {
		border: 1px solid green;
		float: left;
		padding: 10px;
		margin: 10px;
	}
	.nodename {
		color: forestgreen;
		font-weight: bold;
	}
</style>

<head>
	<script>

		window.onload = function() {

			var xhttp = new XMLHttpRequest();

			xhttp.onreadystatechange = function() {
				if(this.readyState == 4 && this.status == 200)
					presentData(JSON.parse(this.responseText));
			}
			xhttp.open("GET", "/status", true);
			xhttp.send();

			var container = document.getElementById("container");
		}

		function presentData(json) {
		
			slaves = json.slaves;
		
			for(var i=0; i<slaves.length; i++) {
			
				slave = slaves[i];
				Object.keys(slave).forEach(function(key) {
					json = slave[key];
					var d = new Date(json.sysInfo.startTime);
					var h = new Date(json.heartBeat);
					container.innerHTML += 
						`<div class='node'>
							<span class='nodename'>Node&lt;${json.host}&gt;</span><br/><hr/>
							<span>Host: </span> <span>${json.host}</span>&nbsp;&nbsp;<span>Agent Port: </span><span>${json.agentPort}</span><br/>
							<span>CPU Cores: </span><span>${json.sysInfo.cores}</span><br/>
							<span>Available Memory: </span><span>${tof2(json.sysInfo.availableMemory / 1024 / 1024)}MB</span><br/>
							<span>Free Memory: </span><span>${tof2(json.sysInfo.freeMemory / 1024 / 1024)}MB</span><br/>
							<span>Starttime:</span><span>${d.toLocaleString()}</span><br/>
							<span>Last Heartbeat:</span><span>${h.toLocaleString()}</span><br/>
							<span>Processes:</span><span>${json.processes.length}</span><br/>
						</div>`;
				});
			}
		}
		
		function tof2(x){ return parseFloat(Math.round(x * 100) / 100).toFixed(2);}

	</script>
</head>	

<body>
	<div id="container">
		
	</div>
</body>

</html>
